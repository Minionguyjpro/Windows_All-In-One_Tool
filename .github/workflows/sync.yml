name: Sync batch file
on:
 push:
 schedule:
 - cron: '0 * * * *'
 workflow_dispatch:
jobs:
 sync:
  runs-on: windows-latest
  steps:
  - uses: actions/checkout@v4

  - name: Download the file
    run: |
      curl -L '${{ secrets.onedrive_url }}' \
        -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:127.0) Gecko/20100101 Firefox/127.0' \
        -H 'Accept: application/json' \
        -H 'Accept-Language: nl-nl' \
        -H 'Referer: https://onedrive.live.com/' \
        -H 'Origin: https://onedrive.live.com' \
        -H 'Sec-Fetch-Dest: empty' \
        -H 'Sec-Fetch-Mode: cors' \
        -H 'Sec-Fetch-Site: cross-site' \
        -H 'Authorization: bearer EwA4A61DBAAUQCpJ6x8%2b/2gxByqQRW1qGaCOQEMAAWu0ulx%2bi3RVe30xnpkXM7ZOL9%2bv4BZAG1A5BuUDyR%2bkkCSBZM6XdnxTUiH6qmf4YeMZaiMWCypUfIR1H0HIoyxpardGO61MR0zJ5gjdS6tEeTHuEcrqMvPqVJVfZ1ZVqOQnX4eoLKDKEKx2A3QsjkADfenPjl7ECVS70jIncQBnVFS15S09lPaI7poSzIfCaZiK9eENmJNmwe/ansA4G4TCWSU6FUyRNo/ambN4sK01ff0VKYr7aBpsqVfvQFEOBHjVIcNB%2bO5qyvECjLMv45i6S5rLguKiH6nXE6BC8y8R0%2bXWUHJZAeTo950X5OC56O0GAGqlajI8jiki%2bwwSOgkQZgAAEPyNo9ffQKN0tujTBs1btAMAAv8SOnsgaNkulXSHCb4xP6HMBjaaM4HtCyey/ZGCLmd0374iFdpgIlVtbQSLOOl2/6aL9YiFCf%2bomF4tBhTTCJHXLFqxPp/kacXn1JJMZomWP/mo6wjDiwUssA5fezDButt73uU6/h6Cmn3TBJrWzq4/CvcVXNtYW8cxU9DjR4Rjqizzab/Od%2bimk53tZGGxL3O8i/8vbMP30yWvwB43bqbXNp4gq/drLW/TobCYhW7T4lJgKCMx3vTB/Jlsd5f5MA2v%2b9Ekc%2buJnd6/IfMU9TXwpluAwX2PGtoTNsI93x3U5%2bkNOf%2b593NFDh3pHFhSzfsLSQ3eUBURCIwHcLX2KS/ejS8abq9uCxU0hnVY/d00%2bkmlbpLvcEqyzW7LSPq5367uRLI0d5MMNS10rwdQfXOMIQMBDA4zxKDiWf7ifJIKfFhbpQfWduVJ4FCEy5hktji1n1kY/FWz9H98Bkfxvke23izd6s6bFdR0IahDrLJEr6wC1oKc3b%2bDbAdXGLtgJCS6InNsFVvknkRVLcl%2b1AagF1/Gvv35NIbpmqWV73MkQnv3DJBHDy2rg1T9nJzOT0i655BLSAMb7UGXpHvav8TvIMTh/vnfJouCuuNxSLcWNCmUXBA2IQzZEjngFwkNGbClj2ci3JHww1m9W9wwU3WKHeFTKSmXQdLKh22QlvtNNwI%3d' \
        -H 'Connection: keep-alive' \
        -H 'TE: trailers'

  - name: Push changes with Git
    run: |
      git config --global user.name "github-actions[bot]"
      git config --global user.email "github-actions[bot]@users.noreply.github.com"
      git pull
      git add .
      git commit -am "Auto-sync Windows_All-In-One_Tool.bat"
      git push origin ${{ github.ref_name }}
